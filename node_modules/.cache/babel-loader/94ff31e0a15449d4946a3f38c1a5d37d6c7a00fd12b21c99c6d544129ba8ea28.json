{"ast":null,"code":"export const DEFAULT_CAPACITY = 128;\nclass LRUNode {\n  key;\n  next;\n  prev;\n  constructor(key) {\n    this.key = key;\n    this.next = this.prev = this;\n  }\n}\nexport class LRUCache {\n  capacity;\n  __internal__data = new Map();\n  __internal__refs = new Map();\n  __internal__length = 0;\n  __internal__head;\n  __internal__tail;\n  constructor(capacity = DEFAULT_CAPACITY) {\n    this.capacity = capacity;\n    this.__internal__head = this.__internal__tail = new LRUNode('<empty>');\n  }\n  get length() {\n    return this.__internal__length;\n  }\n  get lengthData() {\n    return this.__internal__data.size;\n  }\n  get lengthRefs() {\n    return this.__internal__refs.size;\n  }\n  entries() {\n    const keys = this.keys();\n    const count = keys.length;\n    const entries = new Array(count);\n    for (let i = 0; i < count; i++) {\n      const key = keys[i];\n      entries[i] = [key, this.__internal__data.get(key)];\n    }\n    return entries;\n  }\n  keys() {\n    const keys = [];\n    if (this.__internal__length) {\n      let curr = this.__internal__head;\n      while (curr !== this.__internal__tail) {\n        keys.push(curr.key);\n        curr = curr.next;\n      }\n      keys.push(curr.key);\n    }\n    return keys;\n  }\n  get(key) {\n    const data = this.__internal__data.get(key);\n    if (data) {\n      this.__internal__toHead(key);\n      return data;\n    }\n    return null;\n  }\n  set(key, value) {\n    if (this.__internal__data.has(key)) {\n      this.__internal__toHead(key);\n    } else {\n      const node = new LRUNode(key);\n      this.__internal__refs.set(node.key, node);\n      if (this.length === 0) {\n        this.__internal__head = this.__internal__tail = node;\n      } else {\n        this.__internal__head.prev = node;\n        node.next = this.__internal__head;\n        this.__internal__head = node;\n      }\n      if (this.__internal__length === this.capacity) {\n        this.__internal__data.delete(this.__internal__tail.key);\n        this.__internal__refs.delete(this.__internal__tail.key);\n        this.__internal__tail = this.__internal__tail.prev;\n        this.__internal__tail.next = this.__internal__head;\n      } else {\n        this.__internal__length += 1;\n      }\n    }\n    this.__internal__data.set(key, value);\n  }\n  __internal__toHead(key) {\n    const ref = this.__internal__refs.get(key);\n    if (ref && ref !== this.__internal__head) {\n      ref.prev.next = ref.next;\n      ref.next.prev = ref.prev;\n      ref.next = this.__internal__head;\n      this.__internal__head.prev = ref;\n      this.__internal__head = ref;\n    }\n  }\n}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}