{"ast":null,"code":"import { bnToBn, isBigInt, isBn, isBoolean, isCodec, isNumber, stringify } from '@polkadot/util';\n/** @internal **/\nfunction isArrayLike(arg) {\n  return arg instanceof Uint8Array || Array.isArray(arg);\n}\n/** @internal **/\nfunction isEnum(arg) {\n  return isCodec(arg) && isNumber(arg.index) && isCodec(arg.value);\n}\n/** @internal **/\nfunction isOption(arg) {\n  return isCodec(arg) && isBoolean(arg.isSome) && isCodec(arg.value);\n}\n/** @internal */\nfunction isNumberLike(arg) {\n  return isNumber(arg) || isBn(arg) || isBigInt(arg);\n}\n/** @internal */\nfunction sortArray(a, b) {\n  // Vec, Tuple, Bytes etc.\n  let sortRes = 0;\n  const minLen = Math.min(a.length, b.length);\n  for (let i = 0; i < minLen; ++i) {\n    sortRes = sortAsc(a[i], b[i]);\n    if (sortRes !== 0) {\n      return sortRes;\n    }\n  }\n  return a.length - b.length;\n}\n/** @internal */\nfunction checkForDuplicates(container, seen, arg) {\n  // Convert the value to hex.\n  if (isCodec(arg)) {\n    const hex = arg.toHex();\n    // Check if we have seen the value.\n    if (seen.has(hex)) {\n      // Duplicates are not allowed.\n      throw new Error(`Duplicate value in ${container}: ${stringify(arg)}`);\n    }\n    seen.add(hex);\n  }\n  return true;\n}\n/**\n* Sort keys/values of BTreeSet/BTreeMap in ascending order for encoding compatibility with Rust's BTreeSet/BTreeMap\n* (https://doc.rust-lang.org/stable/std/collections/struct.BTreeSet.html)\n* (https://doc.rust-lang.org/stable/std/collections/struct.BTreeMap.html)\n*/\nexport function sortAsc(a, b) {\n  if (isNumberLike(a) && isNumberLike(b)) {\n    return bnToBn(a).cmp(bnToBn(b));\n  } else if (a instanceof Map && b instanceof Map) {\n    return sortAsc(Array.from(a.values()), Array.from(b.values()));\n  } else if (isEnum(a) && isEnum(b)) {\n    return sortAsc(a.index, b.index) || sortAsc(a.value, b.value);\n  } else if (isOption(a) && isOption(b)) {\n    return sortAsc(a.isNone ? 0 : 1, b.isNone ? 0 : 1) || sortAsc(a.value, b.value);\n  } else if (isArrayLike(a) && isArrayLike(b)) {\n    return sortArray(a, b);\n  } else if (isCodec(a) && isCodec(b)) {\n    // Text, Bool etc.\n    return sortAsc(a.toU8a(true), b.toU8a(true));\n  }\n  throw new Error(`Attempting to sort unrecognized values: ${stringify(a)} (typeof ${typeof a}) <-> ${stringify(b)} (typeof ${typeof b})`);\n}\nexport function sortSet(set) {\n  const seen = new Set();\n  return new Set(Array.from(set).filter(value => checkForDuplicates('BTreeSet', seen, value)).sort(sortAsc));\n}\nexport function sortMap(map) {\n  const seen = new Set();\n  return new Map(Array.from(map.entries()).filter(([key]) => checkForDuplicates('BTreeMap', seen, key)).sort(([keyA], [keyB]) => sortAsc(keyA, keyB)));\n}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}