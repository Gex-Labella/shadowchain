{"ast":null,"code":"import { u8aToBn } from '@polkadot/util';\nimport { BN_LE_OPTS } from '../bn.js';\nimport { ALLOWED_PARAMS } from './defaults.js';\nexport function scryptFromU8a(data) {\n  if (!(data instanceof Uint8Array)) {\n    throw new Error('Expected input to be a Uint8Array');\n  }\n  // Ensure the input is exactly 44 bytes: 32 for salt + 3 * 4 for N, p, r\n  if (data.length < 32 + 12) {\n    throw new Error(`Invalid input length: expected 44 bytes, found ${data.length}`);\n  }\n  const salt = data.subarray(0, 32);\n  const N = u8aToBn(data.subarray(32, 36), BN_LE_OPTS).toNumber();\n  const p = u8aToBn(data.subarray(36, 40), BN_LE_OPTS).toNumber();\n  const r = u8aToBn(data.subarray(40, 44), BN_LE_OPTS).toNumber();\n  if (N > 1 << 20 || p > 4 || r > 16) {\n    throw new Error('Scrypt parameters exceed safe limits');\n  }\n  const isAllowed = ALLOWED_PARAMS.some(preset => preset.N === N && preset.p === p && preset.r === r);\n  if (!isAllowed) {\n    throw new Error('Invalid injected scrypt params found');\n  }\n  return {\n    params: {\n      N,\n      p,\n      r\n    },\n    salt\n  };\n}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}