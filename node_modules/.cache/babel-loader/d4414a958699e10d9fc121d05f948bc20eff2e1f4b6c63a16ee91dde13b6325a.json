{"ast":null,"code":"import { extractAuthor } from './util.js';\nfunction mapExtrinsics(extrinsics, records) {\n  return extrinsics.map((extrinsic, index) => {\n    let dispatchError;\n    let dispatchInfo;\n    const events = records.filter(({\n      phase\n    }) => phase.isApplyExtrinsic && phase.asApplyExtrinsic.eq(index)).map(({\n      event\n    }) => {\n      if (event.section === 'system') {\n        if (event.method === 'ExtrinsicSuccess') {\n          dispatchInfo = event.data[0];\n        } else if (event.method === 'ExtrinsicFailed') {\n          dispatchError = event.data[0];\n          dispatchInfo = event.data[1];\n        }\n      }\n      return event;\n    });\n    return {\n      dispatchError,\n      dispatchInfo,\n      events,\n      extrinsic\n    };\n  });\n}\nexport function createSignedBlockExtended(registry, block, events, validators, author) {\n  // an instance of the base extrinsic for us to extend\n  const SignedBlockBase = registry.createClass('SignedBlock');\n  class Implementation extends SignedBlockBase {\n    __internal__author;\n    __internal__events;\n    __internal__extrinsics;\n    constructor(registry, block, events, validators, author) {\n      super(registry, block);\n      this.__internal__author = author || extractAuthor(this.block.header.digest, validators || []);\n      this.__internal__events = events || [];\n      this.__internal__extrinsics = mapExtrinsics(this.block.extrinsics, this.__internal__events);\n      this.createdAtHash = block?.createdAtHash;\n    }\n    /**\n     * @description Convenience method, returns the author for the block\n     */\n    get author() {\n      return this.__internal__author;\n    }\n    /**\n     * @description Convenience method, returns the events associated with the block\n     */\n    get events() {\n      return this.__internal__events;\n    }\n    /**\n     * @description Returns the extrinsics and their events, mapped\n     */\n    get extrinsics() {\n      return this.__internal__extrinsics;\n    }\n  }\n  return new Implementation(registry, block, events, validators, author);\n}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}