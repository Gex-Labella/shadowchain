{"ast":null,"code":"import { u8aConcat } from '@polkadot/util';\nimport { naclEncrypt, scryptEncode, scryptToU8a } from '@polkadot/util-crypto';\nimport { PAIR_DIV, PAIR_HDR } from './defaults.js';\n/**\n * Encode a pair with the latest generation format (generation 3)\n **/\nexport function encodePair({\n  publicKey,\n  secretKey\n}, passphrase) {\n  if (!secretKey) {\n    throw new Error('Expected a valid secretKey to be passed to encode');\n  }\n  const encoded = u8aConcat(PAIR_HDR, secretKey, PAIR_DIV, publicKey);\n  if (!passphrase) {\n    return encoded;\n  }\n  // this is only for generation 3 (previous generations are only handled in decoding)\n  const {\n    params,\n    password,\n    salt\n  } = scryptEncode(passphrase);\n  const {\n    encrypted,\n    nonce\n  } = naclEncrypt(encoded, password.subarray(0, 32));\n  return u8aConcat(scryptToU8a(salt, params), nonce, encrypted);\n}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}