{"ast":null,"code":"import { u8aToBn } from '@polkadot/util';\nimport { BN_LE_OPTS } from '../bn.js';\nimport { DEFAULT_PARAMS } from './defaults.js';\nexport function scryptFromU8a(data) {\n  const salt = data.subarray(0, 32);\n  const N = u8aToBn(data.subarray(32 + 0, 32 + 4), BN_LE_OPTS).toNumber();\n  const p = u8aToBn(data.subarray(32 + 4, 32 + 8), BN_LE_OPTS).toNumber();\n  const r = u8aToBn(data.subarray(32 + 8, 32 + 12), BN_LE_OPTS).toNumber();\n  // FIXME At this moment we assume these to be fixed params, this is not a great idea\n  // since we lose flexibility and updates for greater security. However we need some\n  // protection against carefully-crafted params that can eat up CPU since these are user\n  // inputs. So we need to get very clever here, but atm we only allow the defaults\n  // and if no match, bail out\n  if (N !== DEFAULT_PARAMS.N || p !== DEFAULT_PARAMS.p || r !== DEFAULT_PARAMS.r) {\n    throw new Error('Invalid injected scrypt params found');\n  }\n  return {\n    params: {\n      N,\n      p,\n      r\n    },\n    salt\n  };\n}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}