{"ast":null,"code":"import { stringToU8a, u8aFixLength } from '@polkadot/util';\nimport { naclDecrypt } from '../nacl/index.js';\nimport { scryptEncode, scryptFromU8a } from '../scrypt/index.js';\nimport { ENCODING, NONCE_LENGTH, SCRYPT_LENGTH } from './constants.js';\nexport function jsonDecryptData(encrypted, passphrase, encType = ENCODING) {\n  if (!encrypted) {\n    throw new Error('No encrypted data available to decode');\n  } else if (encType.includes('xsalsa20-poly1305') && !passphrase) {\n    throw new Error('Password required to decode encrypted data');\n  }\n  let encoded = encrypted;\n  if (passphrase) {\n    let password;\n    if (encType.includes('scrypt')) {\n      const {\n        params,\n        salt\n      } = scryptFromU8a(encrypted);\n      password = scryptEncode(passphrase, salt, params).password;\n      encrypted = encrypted.subarray(SCRYPT_LENGTH);\n    } else {\n      password = stringToU8a(passphrase);\n    }\n    encoded = naclDecrypt(encrypted.subarray(NONCE_LENGTH), encrypted.subarray(0, NONCE_LENGTH), u8aFixLength(password, 256, true));\n  }\n  if (!encoded) {\n    throw new Error('Unable to decode using the supplied passphrase');\n  }\n  return encoded;\n}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}