{"ast":null,"code":"import { U8aFixed } from '@polkadot/types-codec';\nimport { BN, bnToU8a, isNumber, stringToU8a, u8aToHex, u8aToString } from '@polkadot/util';\nexport const CID_AURA = /*#__PURE__*/stringToU8a('aura');\nexport const CID_BABE = /*#__PURE__*/stringToU8a('BABE');\nexport const CID_GRPA = /*#__PURE__*/stringToU8a('FRNK');\nexport const CID_POW = /*#__PURE__*/stringToU8a('pow_');\nexport const CID_NMBS = /*#__PURE__*/stringToU8a('nmbs');\nfunction getAuraAuthor(registry, bytes, sessionValidators) {\n  return sessionValidators[registry.createTypeUnsafe('RawAuraPreDigest', [bytes.toU8a(true)]).slotNumber.mod(new BN(sessionValidators.length)).toNumber()];\n}\nfunction getBabeAuthor(registry, bytes, sessionValidators) {\n  const digest = registry.createTypeUnsafe('RawBabePreDigestCompat', [bytes.toU8a(true)]);\n  return sessionValidators[digest.value.toNumber()];\n}\nfunction getBytesAsAuthor(registry, bytes) {\n  return registry.createTypeUnsafe('AccountId', [bytes]);\n}\n/**\n * @name GenericConsensusEngineId\n * @description\n * A 4-byte identifier identifying the engine\n */\nexport class GenericConsensusEngineId extends U8aFixed {\n  constructor(registry, value) {\n    super(registry, isNumber(value) ? bnToU8a(value, {\n      isLe: false\n    }) : value, 32);\n  }\n  /**\n   * @description `true` if the engine matches aura\n   */\n  get isAura() {\n    return this.eq(CID_AURA);\n  }\n  /**\n   * @description `true` is the engine matches babe\n   */\n  get isBabe() {\n    return this.eq(CID_BABE);\n  }\n  /**\n   * @description `true` is the engine matches grandpa\n   */\n  get isGrandpa() {\n    return this.eq(CID_GRPA);\n  }\n  /**\n   * @description `true` is the engine matches pow\n   */\n  get isPow() {\n    return this.eq(CID_POW);\n  }\n  /**\n   * @description `true` is the engine matches nimbus\n   */\n  get isNimbus() {\n    return this.eq(CID_NMBS);\n  }\n  /**\n   * @description From the input bytes, decode into an author\n   */\n  extractAuthor(bytes, sessionValidators) {\n    if (sessionValidators?.length) {\n      if (this.isAura) {\n        return getAuraAuthor(this.registry, bytes, sessionValidators);\n      } else if (this.isBabe) {\n        return getBabeAuthor(this.registry, bytes, sessionValidators);\n      }\n    }\n    // For pow & Nimbus, the bytes are the actual author\n    if (this.isPow || this.isNimbus) {\n      return getBytesAsAuthor(this.registry, bytes);\n    }\n    return undefined;\n  }\n  /**\n   * @description Converts the Object to to a human-friendly JSON, with additional fields, expansion and formatting of information\n   */\n  toHuman() {\n    return this.toString();\n  }\n  /**\n   * @description Returns the base runtime type name for this instance\n   */\n  toRawType() {\n    return 'ConsensusEngineId';\n  }\n  /**\n   * @description Override the default toString to return a 4-byte string\n   */\n  toString() {\n    return this.isAscii ? u8aToString(this) : u8aToHex(this);\n  }\n}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}