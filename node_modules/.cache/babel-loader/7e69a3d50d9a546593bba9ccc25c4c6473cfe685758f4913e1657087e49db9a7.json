{"ast":null,"code":"import { asapScheduler, Observable, Subscription } from 'rxjs';\n/** @internal */\nexport function refCountDelay(delay = 1750) {\n  return source => {\n    // state: 0 = disconnected, 1 = disconnecting, 2 = connecting, 3 = connected\n    let [state, refCount, connection, scheduler] = [0, 0, Subscription.EMPTY, Subscription.EMPTY];\n    return new Observable(ob => {\n      source.subscribe(ob);\n      if (refCount++ === 0) {\n        if (state === 1) {\n          scheduler.unsubscribe();\n        } else {\n          // eslint-disable-next-line deprecation/deprecation\n          connection = source.connect();\n        }\n        state = 3;\n      }\n      return () => {\n        if (--refCount === 0) {\n          if (state === 2) {\n            state = 0;\n            scheduler.unsubscribe();\n          } else {\n            // state === 3\n            state = 1;\n            scheduler = asapScheduler.schedule(() => {\n              state = 0;\n              connection.unsubscribe();\n            }, delay);\n          }\n        }\n      };\n    });\n  };\n}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}