{"ast":null,"code":"/**\r\n * OAuth Service for handling social account connections\r\n */\n\nimport axios from 'axios';\nimport { config } from '../config/environment';\nconst API_BASE = config.api.baseUrl;\n\n// Configure axios defaults\naxios.defaults.timeout = config.api.timeout;\naxios.interceptors.response.use(response => response, error => {\n  var _error$response;\n  // Handle common errors\n  if (((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status) === 401) {\n    console.error('Unauthorized request');\n  }\n  return Promise.reject(error);\n});\nexport class OAuthService {\n  /**\r\n   * Initialize GitHub OAuth flow\r\n   */\n  async connectGitHub(userAddress) {\n    try {\n      const response = await axios.post(`${API_BASE}/auth/github/connect`, {\n        userAddress\n      });\n      return response.data.authUrl;\n    } catch (error) {\n      console.error('Failed to connect GitHub:', error);\n      throw new Error('Failed to initialize GitHub connection');\n    }\n  }\n\n  /**\r\n   * Get user's connected accounts\r\n   */\n  async getConnections(userAddress) {\n    try {\n      const response = await axios.get(`${API_BASE}/auth/connections/${userAddress}`);\n      return response.data.connections.map(conn => ({\n        ...conn,\n        connectedAt: new Date(conn.connectedAt)\n      }));\n    } catch (error) {\n      console.error('Failed to get connections:', error);\n      return [];\n    }\n  }\n\n  /**\r\n   * Revoke a connection\r\n   */\n  async revokeConnection(userAddress, service) {\n    try {\n      await axios.delete(`${API_BASE}/auth/connections/${userAddress}/${service}`);\n    } catch (error) {\n      console.error('Failed to revoke connection:', error);\n      throw new Error('Failed to revoke connection');\n    }\n  }\n\n  /**\r\n   * Check if user has a valid GitHub token\r\n   */\n  async hasValidGitHubToken(userAddress) {\n    try {\n      const response = await axios.get(`${API_BASE}/auth/github/status/${userAddress}`);\n      return response.data.hasValidToken;\n    } catch (error) {\n      console.error('Failed to check GitHub token status:', error);\n      return false;\n    }\n  }\n}\nexport const oauthService = new OAuthService();","map":{"version":3,"names":["axios","config","API_BASE","api","baseUrl","defaults","timeout","interceptors","response","use","error","_error$response","status","console","Promise","reject","OAuthService","connectGitHub","userAddress","post","data","authUrl","Error","getConnections","get","connections","map","conn","connectedAt","Date","revokeConnection","service","delete","hasValidGitHubToken","hasValidToken","oauthService"],"sources":["c:/Users/Admin/Documents/Keiths/Polkadot/shadowchain/frontend/src/services/oauth.ts"],"sourcesContent":["/**\r\n * OAuth Service for handling social account connections\r\n */\r\n\r\nimport axios, { AxiosError } from 'axios';\r\nimport { config } from '../config/environment';\r\n\r\nconst API_BASE = config.api.baseUrl;\r\n\r\n// Configure axios defaults\r\naxios.defaults.timeout = config.api.timeout;\r\naxios.interceptors.response.use(\r\n  (response) => response,\r\n  (error: AxiosError) => {\r\n    // Handle common errors\r\n    if (error.response?.status === 401) {\r\n      console.error('Unauthorized request');\r\n    }\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\nexport interface Connection {\r\n  service: string;\r\n  username: string;\r\n  connectedAt: Date;\r\n}\r\n\r\nexport class OAuthService {\r\n  /**\r\n   * Initialize GitHub OAuth flow\r\n   */\r\n  async connectGitHub(userAddress: string): Promise<string> {\r\n    try {\r\n      const response = await axios.post(`${API_BASE}/auth/github/connect`, {\r\n        userAddress,\r\n      });\r\n      return response.data.authUrl;\r\n    } catch (error) {\r\n      console.error('Failed to connect GitHub:', error);\r\n      throw new Error('Failed to initialize GitHub connection');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get user's connected accounts\r\n   */\r\n  async getConnections(userAddress: string): Promise<Connection[]> {\r\n    try {\r\n      const response = await axios.get(`${API_BASE}/auth/connections/${userAddress}`);\r\n      return response.data.connections.map((conn: any) => ({\r\n        ...conn,\r\n        connectedAt: new Date(conn.connectedAt),\r\n      }));\r\n    } catch (error) {\r\n      console.error('Failed to get connections:', error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Revoke a connection\r\n   */\r\n  async revokeConnection(userAddress: string, service: string): Promise<void> {\r\n    try {\r\n      await axios.delete(`${API_BASE}/auth/connections/${userAddress}/${service}`);\r\n    } catch (error) {\r\n      console.error('Failed to revoke connection:', error);\r\n      throw new Error('Failed to revoke connection');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Check if user has a valid GitHub token\r\n   */\r\n  async hasValidGitHubToken(userAddress: string): Promise<boolean> {\r\n    try {\r\n      const response = await axios.get(`${API_BASE}/auth/github/status/${userAddress}`);\r\n      return response.data.hasValidToken;\r\n    } catch (error) {\r\n      console.error('Failed to check GitHub token status:', error);\r\n      return false;\r\n    }\r\n  }\r\n}\r\n\r\nexport const oauthService = new OAuthService();"],"mappings":"AAAA;AACA;AACA;;AAEA,OAAOA,KAAK,MAAsB,OAAO;AACzC,SAASC,MAAM,QAAQ,uBAAuB;AAE9C,MAAMC,QAAQ,GAAGD,MAAM,CAACE,GAAG,CAACC,OAAO;;AAEnC;AACAJ,KAAK,CAACK,QAAQ,CAACC,OAAO,GAAGL,MAAM,CAACE,GAAG,CAACG,OAAO;AAC3CN,KAAK,CAACO,YAAY,CAACC,QAAQ,CAACC,GAAG,CAC5BD,QAAQ,IAAKA,QAAQ,EACrBE,KAAiB,IAAK;EAAA,IAAAC,eAAA;EACrB;EACA,IAAI,EAAAA,eAAA,GAAAD,KAAK,CAACF,QAAQ,cAAAG,eAAA,uBAAdA,eAAA,CAAgBC,MAAM,MAAK,GAAG,EAAE;IAClCC,OAAO,CAACH,KAAK,CAAC,sBAAsB,CAAC;EACvC;EACA,OAAOI,OAAO,CAACC,MAAM,CAACL,KAAK,CAAC;AAC9B,CACF,CAAC;AAQD,OAAO,MAAMM,YAAY,CAAC;EACxB;AACF;AACA;EACE,MAAMC,aAAaA,CAACC,WAAmB,EAAmB;IACxD,IAAI;MACF,MAAMV,QAAQ,GAAG,MAAMR,KAAK,CAACmB,IAAI,CAAC,GAAGjB,QAAQ,sBAAsB,EAAE;QACnEgB;MACF,CAAC,CAAC;MACF,OAAOV,QAAQ,CAACY,IAAI,CAACC,OAAO;IAC9B,CAAC,CAAC,OAAOX,KAAK,EAAE;MACdG,OAAO,CAACH,KAAK,CAAC,2BAA2B,EAAEA,KAAK,CAAC;MACjD,MAAM,IAAIY,KAAK,CAAC,wCAAwC,CAAC;IAC3D;EACF;;EAEA;AACF;AACA;EACE,MAAMC,cAAcA,CAACL,WAAmB,EAAyB;IAC/D,IAAI;MACF,MAAMV,QAAQ,GAAG,MAAMR,KAAK,CAACwB,GAAG,CAAC,GAAGtB,QAAQ,qBAAqBgB,WAAW,EAAE,CAAC;MAC/E,OAAOV,QAAQ,CAACY,IAAI,CAACK,WAAW,CAACC,GAAG,CAAEC,IAAS,KAAM;QACnD,GAAGA,IAAI;QACPC,WAAW,EAAE,IAAIC,IAAI,CAACF,IAAI,CAACC,WAAW;MACxC,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,OAAOlB,KAAK,EAAE;MACdG,OAAO,CAACH,KAAK,CAAC,4BAA4B,EAAEA,KAAK,CAAC;MAClD,OAAO,EAAE;IACX;EACF;;EAEA;AACF;AACA;EACE,MAAMoB,gBAAgBA,CAACZ,WAAmB,EAAEa,OAAe,EAAiB;IAC1E,IAAI;MACF,MAAM/B,KAAK,CAACgC,MAAM,CAAC,GAAG9B,QAAQ,qBAAqBgB,WAAW,IAAIa,OAAO,EAAE,CAAC;IAC9E,CAAC,CAAC,OAAOrB,KAAK,EAAE;MACdG,OAAO,CAACH,KAAK,CAAC,8BAA8B,EAAEA,KAAK,CAAC;MACpD,MAAM,IAAIY,KAAK,CAAC,6BAA6B,CAAC;IAChD;EACF;;EAEA;AACF;AACA;EACE,MAAMW,mBAAmBA,CAACf,WAAmB,EAAoB;IAC/D,IAAI;MACF,MAAMV,QAAQ,GAAG,MAAMR,KAAK,CAACwB,GAAG,CAAC,GAAGtB,QAAQ,uBAAuBgB,WAAW,EAAE,CAAC;MACjF,OAAOV,QAAQ,CAACY,IAAI,CAACc,aAAa;IACpC,CAAC,CAAC,OAAOxB,KAAK,EAAE;MACdG,OAAO,CAACH,KAAK,CAAC,sCAAsC,EAAEA,KAAK,CAAC;MAC5D,OAAO,KAAK;IACd;EACF;AACF;AAEA,OAAO,MAAMyB,YAAY,GAAG,IAAInB,YAAY,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}