{"ast":null,"code":"import { combineLatest, map, of, switchMap } from 'rxjs';\nimport { memo } from '../util/index.js';\nfunction _membersPrev(api, accountIds) {\n  return combineLatest([of(accountIds), api.query.society.payouts.multi(accountIds), api.query.society['strikes'].multi(accountIds), api.query.society.defenderVotes.multi(accountIds), api.query.society.suspendedMembers.multi(accountIds), api.query.society['vouching'].multi(accountIds)]).pipe(map(([accountIds, payouts, strikes, defenderVotes, suspended, vouching]) => accountIds.map((accountId, index) => ({\n    accountId,\n    isDefenderVoter: defenderVotes[index].isSome,\n    isSuspended: suspended[index].isTrue,\n    payouts: payouts[index],\n    strikes: strikes[index],\n    vote: defenderVotes[index].unwrapOr(undefined),\n    vouching: vouching[index].unwrapOr(undefined)\n  }))));\n}\nfunction _membersCurr(api, accountIds) {\n  return combineLatest([of(accountIds), api.query.society.members.multi(accountIds), api.query.society.payouts.multi(accountIds), api.query.society.challengeRoundCount().pipe(switchMap(round => api.query.society.defenderVotes.multi(accountIds.map(accountId => [round, accountId])))), api.query.society.suspendedMembers.multi(accountIds)]).pipe(map(([accountIds, members, payouts, defenderVotes, suspendedMembers]) => accountIds.map((accountId, index) => members[index].isSome ? {\n    accountId,\n    isDefenderVoter: defenderVotes[index].isSome,\n    isSuspended: suspendedMembers[index].isSome,\n    member: members[index].unwrap(),\n    payouts: payouts[index].payouts\n  } : null).filter(m => !!m).map(({\n    accountId,\n    isDefenderVoter,\n    isSuspended,\n    member,\n    payouts\n  }) => ({\n    accountId,\n    isDefenderVoter,\n    isSuspended,\n    payouts,\n    strikes: member.strikes,\n    vouching: member.vouching.unwrapOr(undefined)\n  }))));\n}\nexport function _members(instanceId, api) {\n  return memo(instanceId, accountIds => api.query.society.members.creator.meta.type.isMap ? _membersCurr(api, accountIds) : _membersPrev(api, accountIds));\n}\n/**\n * @description Get the member info for a society\n */\nexport function members(instanceId, api) {\n  return memo(instanceId, () => api.query.society.members.creator.meta.type.isMap ? api.query.society.members.keys().pipe(switchMap(keys => api.derive.society._members(keys.map(({\n    args: [accountId]\n  }) => accountId)))) : api.query.society.members().pipe(switchMap(members => api.derive.society._members(members))));\n}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}