{"ast":null,"code":"import { map, of } from 'rxjs';\nimport { memo } from '../util/index.js';\nimport { filterCachedEras, getEraMultiCache, setEraMultiCache } from './cache.js';\nimport { erasHistoricApply, filterEras } from './util.js';\nconst CACHE_KEY = 'eraRewards';\nfunction mapRewards(eras, optRewards) {\n  return eras.map((era, index) => ({\n    era,\n    eraReward: optRewards[index].unwrapOrDefault()\n  }));\n}\nexport function _erasRewards(instanceId, api) {\n  return memo(instanceId, (eras, withActive) => {\n    if (!eras.length) {\n      return of([]);\n    }\n    const cached = getEraMultiCache(CACHE_KEY, eras, withActive);\n    const remaining = filterEras(eras, cached);\n    if (!remaining.length) {\n      return of(cached);\n    }\n    return api.query.staking.erasValidatorReward.multi(remaining).pipe(map(r => filterCachedEras(eras, cached, setEraMultiCache(CACHE_KEY, withActive, mapRewards(remaining, r)))));\n  });\n}\nexport const erasRewards = /*#__PURE__*/erasHistoricApply('_erasRewards');","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}