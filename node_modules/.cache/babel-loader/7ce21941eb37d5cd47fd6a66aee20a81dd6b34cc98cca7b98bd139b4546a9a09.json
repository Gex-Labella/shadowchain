{"ast":null,"code":"import { combineLatest, map, of, switchMap } from 'rxjs';\nimport { isFunction, objectSpread } from '@polkadot/util';\nimport { memo } from '../util/index.js';\nimport { getImageHashBounded } from './util.js';\nfunction isNewDepositors(depositors) {\n  // Detect balance...\n  return isFunction(depositors[1].mul);\n}\nfunction parse([proposals, images, optDepositors]) {\n  return proposals.filter(([,, proposer], index) => !!optDepositors[index]?.isSome && !proposer.isEmpty).map(([index, hash, proposer], proposalIndex) => {\n    const depositors = optDepositors[proposalIndex].unwrap();\n    return objectSpread({\n      image: images[proposalIndex],\n      imageHash: getImageHashBounded(hash),\n      index,\n      proposer\n    }, isNewDepositors(depositors) ? {\n      balance: depositors[1],\n      seconds: depositors[0]\n    } : {\n      balance: depositors[0],\n      seconds: depositors[1]\n    });\n  });\n}\nexport function proposals(instanceId, api) {\n  return memo(instanceId, () => isFunction(api.query.democracy?.publicProps) ? api.query.democracy.publicProps().pipe(switchMap(proposals => proposals.length ? combineLatest([of(proposals), api.derive.democracy.preimages(proposals.map(([, hash]) => hash)), api.query.democracy.depositOf.multi(proposals.map(([index]) => index))]) : of([[], [], []])), map(parse)) : of([]));\n}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}