{"ast":null,"code":"import { map, of, switchMap } from 'rxjs';\nimport { BN_ZERO, bnToBn, objectSpread } from '@polkadot/util';\nimport { memo } from '../util/index.js';\nimport { getQueryInterface } from './util.js';\nfunction orderBags(ids, bags) {\n  const sorted = ids.map((id, index) => ({\n    bag: bags[index].unwrapOr(null),\n    id,\n    key: id.toString()\n  })).sort((a, b) => b.id.cmp(a.id));\n  const max = sorted.length - 1;\n  return sorted.map((entry, index) => objectSpread(entry, {\n    bagLower: index === max ? BN_ZERO : sorted[index + 1].id,\n    bagUpper: entry.id,\n    index\n  }));\n}\nexport function _getIds(instanceId, api) {\n  const query = getQueryInterface(api);\n  return memo(instanceId, _ids => {\n    const ids = _ids.map(id => bnToBn(id));\n    return ids.length ? query.listBags.multi(ids).pipe(map(bags => orderBags(ids, bags))) : of([]);\n  });\n}\nexport function all(instanceId, api) {\n  const query = getQueryInterface(api);\n  return memo(instanceId, () => query.listBags.keys().pipe(switchMap(keys => api.derive.bagsList._getIds(keys.map(({\n    args: [id]\n  }) => id))), map(list => list.filter(({\n    bag\n  }) => bag))));\n}\nexport function get(instanceId, api) {\n  return memo(instanceId, id => api.derive.bagsList._getIds([bnToBn(id)]).pipe(map(bags => bags[0])));\n}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}