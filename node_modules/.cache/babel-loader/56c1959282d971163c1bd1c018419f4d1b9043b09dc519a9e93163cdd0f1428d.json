{"ast":null,"code":"import { create } from 'zustand';\nimport { web3Accounts, web3Enable, web3FromAddress } from '@polkadot/extension-dapp';\nimport { toast } from 'react-toastify';\nexport const useWalletStore = create((set, get) => ({\n  isInitialized: false,\n  isConnected: false,\n  availableAccounts: [],\n  connectedAccounts: [],\n  selectedAccount: null,\n  injector: null,\n  isAccountSelectionOpen: false,\n  initializeWallet: async () => {\n    try {\n      // Check if extension is installed\n      const extensions = await web3Enable('Shadow Chain');\n      if (extensions.length === 0) {\n        toast.error('Please install Polkadot.js extension');\n        set({\n          isInitialized: true\n        });\n        return;\n      }\n\n      // Don't auto-connect, just mark as initialized\n      set({\n        isInitialized: true\n      });\n    } catch (error) {\n      console.error('Failed to initialize wallet:', error);\n      toast.error('Failed to initialize wallet');\n      set({\n        isInitialized: true\n      });\n    }\n  },\n  openAccountSelection: async () => {\n    try {\n      const extensions = await web3Enable('Shadow Chain');\n      if (extensions.length === 0) {\n        toast.error('Please install Polkadot.js extension');\n        return;\n      }\n      const allAccounts = await web3Accounts();\n      if (allAccounts.length === 0) {\n        toast.error('No accounts found. Please create an account in Polkadot.js extension');\n        return;\n      }\n      set({\n        availableAccounts: allAccounts,\n        isAccountSelectionOpen: true\n      });\n    } catch (error) {\n      console.error('Failed to get accounts:', error);\n      toast.error('Failed to get accounts');\n    }\n  },\n  closeAccountSelection: () => {\n    set({\n      isAccountSelectionOpen: false\n    });\n  },\n  connectAccounts: async accounts => {\n    if (accounts.length === 0) {\n      toast.error('Please select at least one account');\n      return;\n    }\n    try {\n      // Get injector for the first account\n      const injector = await web3FromAddress(accounts[0].address);\n      set({\n        isConnected: true,\n        connectedAccounts: accounts,\n        selectedAccount: accounts[0],\n        injector,\n        isAccountSelectionOpen: false\n      });\n      toast.success(`Connected ${accounts.length} account${accounts.length > 1 ? 's' : ''}`);\n    } catch (error) {\n      console.error('Failed to connect accounts:', error);\n      toast.error('Failed to connect accounts');\n    }\n  },\n  disconnect: () => {\n    // Clear any saved state\n    localStorage.removeItem('shadowchain_account');\n    set({\n      isConnected: false,\n      selectedAccount: null,\n      connectedAccounts: [],\n      availableAccounts: [],\n      injector: null\n    });\n    toast.info('Wallet disconnected');\n  },\n  selectAccount: async account => {\n    try {\n      const injector = await web3FromAddress(account.address);\n      set({\n        isConnected: true,\n        selectedAccount: account,\n        injector\n      });\n      toast.success(`Connected to ${account.meta.name || account.address}`);\n    } catch (error) {\n      console.error('Failed to select account:', error);\n      toast.error('Failed to select account');\n    }\n  },\n  switchAccount: async account => {\n    // Make sure the account is in connected accounts\n    const {\n      connectedAccounts\n    } = get();\n    if (!connectedAccounts.find(acc => acc.address === account.address)) {\n      toast.error('Account not connected');\n      return;\n    }\n    try {\n      const injector = await web3FromAddress(account.address);\n      set({\n        selectedAccount: account,\n        injector\n      });\n      toast.info(`Switched to ${account.meta.name || account.address}`);\n    } catch (error) {\n      console.error('Failed to switch account:', error);\n      toast.error('Failed to switch account');\n    }\n  }\n}));","map":{"version":3,"names":["create","web3Accounts","web3Enable","web3FromAddress","toast","useWalletStore","set","get","isInitialized","isConnected","availableAccounts","connectedAccounts","selectedAccount","injector","isAccountSelectionOpen","initializeWallet","extensions","length","error","console","openAccountSelection","allAccounts","closeAccountSelection","connectAccounts","accounts","address","success","disconnect","localStorage","removeItem","info","selectAccount","account","meta","name","switchAccount","find","acc"],"sources":["C:/Users/Admin/Documents/Keiths/Polkadot/shadowchain/frontend/src/store/wallet.ts"],"sourcesContent":["import { create } from 'zustand';\r\nimport { web3Accounts, web3Enable, web3FromAddress } from '@polkadot/extension-dapp';\r\nimport { InjectedAccountWithMeta } from '@polkadot/extension-inject/types';\r\nimport { toast } from 'react-toastify';\r\n\r\ninterface WalletState {\r\n  isInitialized: boolean;\r\n  isConnected: boolean;\r\n  availableAccounts: InjectedAccountWithMeta[]; // All accounts from extension\r\n  connectedAccounts: InjectedAccountWithMeta[]; // Accounts user chose to connect\r\n  selectedAccount: InjectedAccountWithMeta | null; // Currently active account\r\n  injector: any;\r\n  isAccountSelectionOpen: boolean;\r\n  \r\n  initializeWallet: () => Promise<void>;\r\n  openAccountSelection: () => Promise<void>;\r\n  closeAccountSelection: () => void;\r\n  connectAccounts: (accounts: InjectedAccountWithMeta[]) => Promise<void>;\r\n  disconnect: () => void;\r\n  selectAccount: (account: InjectedAccountWithMeta) => Promise<void>;\r\n  switchAccount: (account: InjectedAccountWithMeta) => Promise<void>;\r\n}\r\n\r\nexport const useWalletStore = create<WalletState>((set, get) => ({\r\n  isInitialized: false,\r\n  isConnected: false,\r\n  availableAccounts: [],\r\n  connectedAccounts: [],\r\n  selectedAccount: null,\r\n  injector: null,\r\n  isAccountSelectionOpen: false,\r\n\r\n  initializeWallet: async () => {\r\n    try {\r\n      // Check if extension is installed\r\n      const extensions = await web3Enable('Shadow Chain');\r\n      \r\n      if (extensions.length === 0) {\r\n        toast.error('Please install Polkadot.js extension');\r\n        set({ isInitialized: true });\r\n        return;\r\n      }\r\n\r\n      // Don't auto-connect, just mark as initialized\r\n      set({ isInitialized: true });\r\n    } catch (error) {\r\n      console.error('Failed to initialize wallet:', error);\r\n      toast.error('Failed to initialize wallet');\r\n      set({ isInitialized: true });\r\n    }\r\n  },\r\n\r\n  openAccountSelection: async () => {\r\n    try {\r\n      const extensions = await web3Enable('Shadow Chain');\r\n      \r\n      if (extensions.length === 0) {\r\n        toast.error('Please install Polkadot.js extension');\r\n        return;\r\n      }\r\n\r\n      const allAccounts = await web3Accounts();\r\n      \r\n      if (allAccounts.length === 0) {\r\n        toast.error('No accounts found. Please create an account in Polkadot.js extension');\r\n        return;\r\n      }\r\n\r\n      set({\r\n        availableAccounts: allAccounts,\r\n        isAccountSelectionOpen: true\r\n      });\r\n    } catch (error) {\r\n      console.error('Failed to get accounts:', error);\r\n      toast.error('Failed to get accounts');\r\n    }\r\n  },\r\n\r\n  closeAccountSelection: () => {\r\n    set({ isAccountSelectionOpen: false });\r\n  },\r\n\r\n  connectAccounts: async (accounts: InjectedAccountWithMeta[]) => {\r\n    if (accounts.length === 0) {\r\n      toast.error('Please select at least one account');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      // Get injector for the first account\r\n      const injector = await web3FromAddress(accounts[0].address);\r\n      \r\n      set({\r\n        isConnected: true,\r\n        connectedAccounts: accounts,\r\n        selectedAccount: accounts[0],\r\n        injector,\r\n        isAccountSelectionOpen: false\r\n      });\r\n      \r\n      toast.success(`Connected ${accounts.length} account${accounts.length > 1 ? 's' : ''}`);\r\n    } catch (error) {\r\n      console.error('Failed to connect accounts:', error);\r\n      toast.error('Failed to connect accounts');\r\n    }\r\n  },\r\n\r\n  disconnect: () => {\r\n    // Clear any saved state\r\n    localStorage.removeItem('shadowchain_account');\r\n    set({\r\n      isConnected: false,\r\n      selectedAccount: null,\r\n      connectedAccounts: [],\r\n      availableAccounts: [],\r\n      injector: null,\r\n    });\r\n    toast.info('Wallet disconnected');\r\n  },\r\n\r\n  selectAccount: async (account: InjectedAccountWithMeta) => {\r\n    try {\r\n      const injector = await web3FromAddress(account.address);\r\n      \r\n      set({\r\n        isConnected: true,\r\n        selectedAccount: account,\r\n        injector,\r\n      });\r\n      \r\n      toast.success(`Connected to ${account.meta.name || account.address}`);\r\n    } catch (error) {\r\n      console.error('Failed to select account:', error);\r\n      toast.error('Failed to select account');\r\n    }\r\n  },\r\n\r\n  switchAccount: async (account: InjectedAccountWithMeta) => {\r\n    // Make sure the account is in connected accounts\r\n    const { connectedAccounts } = get();\r\n    if (!connectedAccounts.find(acc => acc.address === account.address)) {\r\n      toast.error('Account not connected');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const injector = await web3FromAddress(account.address);\r\n      \r\n      set({\r\n        selectedAccount: account,\r\n        injector,\r\n      });\r\n      \r\n      toast.info(`Switched to ${account.meta.name || account.address}`);\r\n    } catch (error) {\r\n      console.error('Failed to switch account:', error);\r\n      toast.error('Failed to switch account');\r\n    }\r\n  },\r\n}));"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}