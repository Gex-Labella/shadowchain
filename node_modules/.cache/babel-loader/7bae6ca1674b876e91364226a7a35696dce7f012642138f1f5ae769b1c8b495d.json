{"ast":null,"code":"import { combineLatest, map, of, switchMap } from 'rxjs';\nimport { memo } from '../util/index.js';\nfunction getPrev(api) {\n  return api.query.society.candidates().pipe(switchMap(candidates => combineLatest([of(candidates), api.query.society['suspendedCandidates'].multi(candidates.map(({\n    who\n  }) => who))])), map(([candidates, suspended]) => candidates.map(({\n    kind,\n    value,\n    who\n  }, index) => ({\n    accountId: who,\n    isSuspended: suspended[index].isSome,\n    kind,\n    value\n  }))));\n}\nfunction getCurr(api) {\n  return api.query.society.candidates.entries().pipe(map(entries => entries.filter(([, opt]) => opt.isSome).map(([{\n    args: [accountId]\n  }, opt]) => [accountId, opt.unwrap()])\n  // FIXME We are missing the new fields from the candidate record\n  .map(([accountId, {\n    bid,\n    kind\n  }]) => ({\n    accountId,\n    isSuspended: false,\n    kind,\n    value: bid\n  }))));\n}\n/**\n * @description Get the candidate info for a society\n */\nexport function candidates(instanceId, api) {\n  return memo(instanceId, () => api.query.society['suspendedCandidates'] && api.query.society.candidates.creator.meta.type.isPlain ? getPrev(api) : getCurr(api));\n}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}